gnome-keyring-daemon --start --components=pkcs11,secrets,ssh -d


. /etc/os-release
case $ID in
    void) 
        pipewire &
        ;;
esac

swayidle -w \
    timeout 300 'swaylock -f -c 000000' \
    timeout 600 'wlopm --off \*' \
    resume 'wlopm --on \*' \
    before-sleep 'swaylock -f -c 000000' >/dev/null 2>&1 &

# Set background color.
swaybg -i ~/.config/bg.jpg -m fill &

# Launch a panel .
if [ $(pgrep -x -c waybar) -eq 0 ]; then
    echo "running waybar"
    waybar &
fi

# Make sure waybar is running
while [ $(pgrep -x -c waybar) -eq 0 ]; do sleep 1; done

if [ $(pgrep -x -c dunst) -eq 0 ]; then
    echo "running dunst"
    dunst &
fi

if [ $(pgrep -x -c kanshi) -eq 0 ]; then
    echo "running kanshi"
    kanshi &
fi

if [ $(pgrep -x -c gammastep) -eq 0 ]; then
    echo "running gammastep"
    gammastep &
fi

if [ $(pgrep -x -c nextcloud) -eq 0 ]; then
    echo "running nextcloud"
    nextcloud &
fi

# if [ $(pgrep -x -c blueman-applet) -eq 0 ]; then
#     echo "running blueman applet"
#     blueman-applet &
# fi

if [ $(pgrep -x -c keepassxc) -eq 0 ]; then
    # Make sure waybar is running
    echo "running KeePass XC"
    sleep 5 && flatpak run org.keepassxc.KeePassXC &
fi

